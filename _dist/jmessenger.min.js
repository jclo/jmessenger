/*! ****************************************************************************
 * JMessenger v0.0.0
 *
 * A tiny Javascript library to handle messages that carry a payload.
 * (you can download it from npm or github repositories)
 * Copyright (c) 2019 jclo <jclo@mobilabs.fr> (http://www.mobilabs.fr/).
 * Released under the MIT license. You may obtain a copy of the License
 * at: http://www.opensource.org/licenses/mit-license.php).
 * ************************************************************************** */
!function(e,t){"use strict";"function"==typeof define&&define.amd?define([""],t):"object"==typeof exports?(module.exports=t(e),null===e.JMessenger&&(e.JMessenger=t(e))):e.JMessenger=t(e)}(this,function(e){"use strict";var t,n,r,i,s;return n={},function(){function r(e,t){Object.prototype.hasOwnProperty.call(e,t)||(e[t]={listeners:[],listenersOnce:[]})}function i(e,t){Object.prototype.hasOwnProperty.call(e,t)||(e[t]={stream:{firing:!1,listeners:[]}})}n.Private={addEvents:function(e,t){var n;if("string"==typeof t)r(e,t);else if(Array.isArray(t))for(n=0;n<t.length;n++)"string"==typeof t[n]&&r(e,t[n])},addStreamEvents:function(e,t){var n;if("string"==typeof t)i(e,t);else if(Array.isArray(t))for(n=0;n<t.length;n++)"string"==typeof t[n]&&i(e,t[n])},fire:function(e,t,n){var r;if("string"==typeof t&&Object.prototype.hasOwnProperty.call(e,t)){for(r=0;r<e[t].listeners.length;r++)e[t].listeners[r](n);for(r=0;r<e[t].listenersOnce.length;r++)e[t].listenersOnce[r](n);e[t].listenersOnce.splice(0,e[t].listenersOnce.length)}},addEventListener:function(e,t,n,r){r&&this.addEvents(e,t),"string"==typeof t&&"function"==typeof n&&Object.prototype.hasOwnProperty.call(e,t)&&e[t].listeners.push(n)},addOneTimeEventListener:function(e,t,n,r){r&&this.addEvents(e,t),"string"==typeof t&&"function"==typeof n&&Object.prototype.hasOwnProperty.call(e,t)&&e[t].listenersOnce.push(n)},removeEventListener:function(e,t,n){var r;"string"==typeof t&&"function"==typeof n&&Object.prototype.hasOwnProperty.call(e,t)&&(0<=(r=e[t].listeners.indexOf(n))&&e[t].listeners.splice(r,1),0<=(r=e[t].listenersOnce.indexOf(n))&&e[t].listenersOnce.splice(r,1))},fireQ:function(e,t,n){var r=e[t].stream,i=r.listeners;r.firing=!0,function e(){0<i.length?i.shift().apply(n||{},[e].concat(Array.prototype.slice.call(arguments,0))):r.firing=!1}()},fireQL:function(e,t,n){var r=e[t].stream,i=r.listeners;r.firing=!0,function e(){if(0<i.length){for(;1<i.length;)i.shift();i.shift().apply(n||{},[e].concat(Array.prototype.slice.call(arguments,0)))}else r.firing=!1}()},addEventStreamListener:function(e,t,n){"string"==typeof t&&"function"==typeof n&&Object.prototype.hasOwnProperty.call(e,t)&&(e[t].stream.listeners.push(n),e[t].stream.firing||this.fireQ(e,t))},addEventStreamListenerLast:function(e,t,n){"string"==typeof t&&"function"==typeof n&&Object.prototype.hasOwnProperty.call(e,t)&&(e[t].stream.listeners.push(n),e[t].stream.firing||this.fireQL(e,t))}}}(),s=n.Private,t=function(e){var t=Object.create(i);return t.db={},t.addEvents(e),t},r=e.JMessenger,t.VERSION="0.0.0",t.noConflict=function(){return e.JMessenger=r,this},i={addEvents:function(e){return s.addEvents(this.db,e),this},addStreamEvents:function(e){return s.addStreamEvents(this.db,e),this},fire:function(e,t){return s.fire(this.db,e,t),this},trigger:function(e,t){return this.fire(e,t)},addEventListener:function(e,t){return s.addEventListener(this.db,e,t,this.open),this},addOneTimeEventListener:function(e,t){return s.addOneTimeEventListener(this.db,e,t,this.open),this},removeEventListener:function(e,t){return s.removeEventListener(this.db,e,t),this},on:function(e,t){return this.addEventListener(e,t)},one:function(e,t){return this.addOneTimeEventListener(e,t)},off:function(e,t){return this.removeEventListener(e,t)},fireQActive:function(e){return this.db[e].stream.firing},fireQ:function(e,t){return s.fireQ(this.db,e,t),this},fireQL:function(e,t){return s.fireQL(this.db,e,t),this},addEventStreamListener:function(e,t){return s.addEventStreamListener(this.db,e,t),this},addEventStreamListenerLast:function(e,t){return s.addEventStreamListenerLast(this.db,e,t),this},q:function(e,t){return this.addEventStreamListener(e,t)},ql:function(e,t){return this.addEventStreamListenerLast(e,t)},setOpen:function(){return this.open=!0,this}},t});